<!doctype html>
<html class="writer-html5" lang="en"> 
 <head> 
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Reviewing and merging patches — Warehouse  documentation</title> 
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css"> 
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"> 
  <link rel="canonical" href="https://warehouse.pypa.io/development/reviewing-patches.html"> <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]--> 
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script> 
  <script src="../_static/jquery.js"></script> 
  <script src="../_static/underscore.js"></script> 
  <script src="../_static/doctools.js"></script> 
  <script async src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script> 
  <script src="../_static/js/theme.js"></script> 
  <link rel="index" title="Index" href="../genindex.html"> 
  <link rel="search" title="Search" href="../search.html"> 
  <link rel="next" title="Legacy Application URL Structure" href="legacy-application-structure.html"> 
  <link rel="prev" title="Submitting patches" href="submitting-patches.html"> <!-- RTD Extra Head --> 
  <link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css"> 
  <script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2022-05-16T21:16:41Z", "builder": "sphinx", "canonical_url": null, "commit": "140a2cc3", "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "development/reviewing-patches", "programming_language": "py", "project": "warehouse", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script> <!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
--> 
  <script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script> 
  <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async></script> <!-- end RTD <extrahead> --> 
 </head> 
 <body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav"> 
   <nav data-toggle="wy-nav-shift" class="wy-nav-side"> 
    <div class="wy-side-scroll"> 
     <div class="wy-side-nav-search"> <a href="../index.html" class="icon icon-home"> Warehouse </a> 
      <div class="version">
        latest 
      </div> 
      <div role="search"> 
       <form id="rtd-search-form" class="wy-form" action="../search.html" method="get"> 
        <input type="text" name="q" placeholder="Search docs"> 
        <input type="hidden" name="check_keywords" value="yes"> 
        <input type="hidden" name="area" value="default"> 
       </form> 
      </div> 
     </div>
     <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu"> 
      <ul class="current"> 
       <li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a>
        <ul class="current"> 
         <li class="toctree-l2"><a class="reference internal" href="getting-started.html">Getting started</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="frontend.html">Frontend</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="patterns.html">Patterns</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="database-migrations.html">Database migrations</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="submitting-patches.html">Submitting patches</a></li> 
         <li class="toctree-l2 current"><a class="current reference internal" href="#">Reviewing and merging patches</a>
          <ul> 
           <li class="toctree-l3"><a class="reference internal" href="#architecture">Architecture</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#intent">Intent</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#implementation">Implementation</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#grammar-and-style">Grammar and style</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#testing-branches-on-your-local-machine">Testing branches on your local machine</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#testing-with-twine">Testing with twine</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#merge-requirements">Merge requirements</a></li> 
          </ul> </li> 
         <li class="toctree-l2"><a class="reference internal" href="legacy-application-structure.html">Legacy Application URL Structure</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="development-database.html">Updating Development Database</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="cloud.html">Developing in the cloud</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="email.html">Working with E-mails</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="malware-checks.html">Malware Checks</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="token-scanning.html">Token Scanning</a></li> 
        </ul> </li> 
       <li class="toctree-l1"><a class="reference internal" href="../application.html">Warehouse codebase</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../api-reference/index.html">API reference</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../ui-principles.html">UI principles</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../translations.html">Translations</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap and Sprints</a></li> 
      </ul> 
     </div> 
    </div> 
   </nav> 
   <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <nav class="wy-nav-top" aria-label="Mobile navigation menu"> <i data-toggle="wy-nav-top" class="fa fa-bars"></i> <a href="../index.html">Warehouse</a> 
    </nav> 
    <div class="wy-nav-content"> 
     <div class="rst-content"> 
      <div role="navigation" aria-label="Page navigation"> 
       <ul class="wy-breadcrumbs"> 
        <li><a href="../index.html" class="icon icon-home"></a> »</li> 
        <li><a href="index.html">Development</a> »</li> 
        <li>Reviewing and merging patches</li> 
        <li class="wy-breadcrumbs-aside"> <a href="https://github.com/pypa/warehouse/blob/main/docs/development/reviewing-patches.rst" class="fa fa-github"> Edit on GitHub</a> </li> 
       </ul> 
       <hr> 
      </div> 
      <div role="main" class="document" itemscope itemtype="http://schema.org/Article"> 
       <div itemprop="articleBody"> 
        <section id="reviewing-and-merging-patches"> 
         <h1>Reviewing and merging patches<a class="headerlink" href="#reviewing-and-merging-patches" title="Permalink to this headline">¶</a></h1> 
         <p>Everyone is encouraged to review open pull requests. We only ask that you try and think carefully, ask questions and are <a class="reference external" href="https://speakerdeck.com/ohrite/better-code-review">excellent to one another</a>. When engaging in code review, remember that you are bound by the <a class="reference external" href="https://github.com/pypa/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a>. Code review is our opportunity to share knowledge, design ideas and make friends.</p> 
         <p>When reviewing a patch try to keep each of these concepts in mind:</p> 
         <section id="architecture"> 
          <h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2> 
          <ul class="simple"> 
           <li><p>Is the proposed change being made in the correct place?</p></li> 
          </ul> 
         </section> 
         <section id="intent"> 
          <h2>Intent<a class="headerlink" href="#intent" title="Permalink to this headline">¶</a></h2> 
          <ul class="simple"> 
           <li><p>What is the change being proposed?</p></li> 
           <li><p>Do we want this feature or is the bug they’re fixing really a bug?</p></li> 
          </ul> 
         </section> 
         <section id="implementation"> 
          <h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2> 
          <ul class="simple"> 
           <li><p>Does the change do what the author claims?</p></li> 
           <li><p>Are there sufficient tests?</p></li> 
           <li><p>Should and has it been documented?</p></li> 
           <li><p>Will this change introduce new bugs?</p></li> 
           <li><p>Are we ensuring that we set <code class="docutils literal notranslate"><span class="pre">rel="noopener"</span></code> whenever using <code class="docutils literal notranslate"><span class="pre">target="_blank_"</span></code> for a hyperlink?</p></li> 
          </ul> 
         </section> 
         <section id="grammar-and-style"> 
          <h2>Grammar and style<a class="headerlink" href="#grammar-and-style" title="Permalink to this headline">¶</a></h2> 
          <p>These are small things that are not caught by the automated style checkers.</p> 
          <ul class="simple"> 
           <li><p>Does a variable need a better name?</p></li> 
           <li><p>Should this be a keyword argument?</p></li> 
          </ul> 
         </section> 
         <section id="testing-branches-on-your-local-machine"> 
          <h2>Testing branches on your local machine<a class="headerlink" href="#testing-branches-on-your-local-machine" title="Permalink to this headline">¶</a></h2> 
          <p>It can be helpful to check out a branch with a pull request (PR) on it, in order to test how the changes in it work on your machine.</p> 
          <p>First, make sure that your local copy of the Warehouse repo is configured with an <code class="docutils literal notranslate"><span class="pre">upstream</span></code> branch so that the following command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git remote -v</span>
</pre>
           </div> 
          </div> 
          <p>Has this output:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">origin  https://github.com/&lt;username&gt;/warehouse.git (fetch)</span>
<span class="go">origin  https://github.com/&lt;username&gt;/warehouse.git (push)</span>
<span class="go">upstream  https://github.com/pypa/warehouse.git (fetch)</span>
<span class="go">upstream  https://github.com/pypa/warehouse.git (push)</span>
</pre>
           </div> 
          </div> 
          <p>In this output, <code class="docutils literal notranslate"><span class="pre">&lt;username&gt;</span></code> is your GitHub username. If you do not have an <code class="docutils literal notranslate"><span class="pre">upstream</span></code> branch configured, you can add one by running the following command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git remote add upstream git@github.com:pypa/warehouse.git</span>
</pre>
           </div> 
          </div> 
          <p>Pull down the PR branch by running these commands:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout main</span>
<span class="go">git fetch upstream pull/&lt;id&gt;/head:&lt;branchname&gt;</span>
</pre>
           </div> 
          </div> 
          <p>In this example, <code class="docutils literal notranslate"><span class="pre">upstream</span></code> refers to the Warehouse repository on GitHub. <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> refers to the sequence of digits after the pull request’s title. <code class="docutils literal notranslate"><span class="pre">&lt;branchname&gt;</span></code> creates a new branch on your machine which has the pull request on it. If you create a branch in your local repository with the name <code class="docutils literal notranslate"><span class="pre">&lt;branchname&gt;</span></code> before pulling down the PR branch, this command will fail.</p> 
          <p>In order to test the branch, first switch to the new branch with the PR on it that you have pulled down:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout &lt;branchname&gt;</span>
</pre>
           </div> 
          </div> 
          <p>Once you are on the PR branch, it’s probably best to rebase the changes against the current main branch. The older the PR is, the more important it is to do this, since differences between main and the PR branch will have accumulated over time. These differences may lead to difficulty in testing the changes in the PR branch.</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout &lt;branchname&gt;</span>
<span class="go">git fetch upstream</span>
<span class="go">git rebase upstream/main</span>
</pre>
           </div> 
          </div> 
          <p>These commands replay the changes in the PR against the main branch. Once you have completed these steps, you are ready to test the PR branch.</p> 
          <p>If you have found any bugs in the course of your testing, you can leave a brief comment describing the issue you encountered on GitHub in the comments under the issue.</p> 
         </section> 
         <section id="testing-with-twine"> 
          <h2>Testing with twine<a class="headerlink" href="#testing-with-twine" title="Permalink to this headline">¶</a></h2> 
          <p>If you are testing Warehouse locally, you may want to use <a class="reference external" href="https://github.com/pypa/twine">twine</a> to try uploading a test package. First, checkout the branch you would like to test. Then, start up the development environment (as described in <a class="reference internal" href="getting-started.html#getting-started"><span class="std std-ref">Getting started</span></a>). Once you have the Warehouse site working on <code class="docutils literal notranslate"><span class="pre">localhost:80</span></code>, you can upload a package to the version of Warehouse running in your development environment with Twine using the following command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">twine upload --repository-url http://localhost/legacy/ -u &lt;username&gt; -p password &lt;path to distribution&gt;</span>
</pre>
           </div> 
          </div> 
          <p>In the command above,</p> 
          <ul class="simple"> 
           <li><p><code class="docutils literal notranslate"><span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">distribution&gt;</span></code> should be a path to a distribution file (or directory of distribution files) of the package you would like to test, likely created by running <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">sdist</span></code>. See the <a class="reference external" href="https://packaging.python.org/tutorials/distributing-packages/#packaging-your-project">Python Packaging User Guide</a> for instructions on how to create a distribution file or directory.</p></li> 
           <li><p><code class="docutils literal notranslate"><span class="pre">&lt;username&gt;</span></code> is the username of the account you would like to test with. Note that your current PyPI username may not exist in the development environment.</p></li> 
           <li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> is the literal string “password”. All passwords in the development environment have been set to this value.</p></li> 
          </ul> 
         </section> 
         <section id="merge-requirements"> 
          <h2>Merge requirements<a class="headerlink" href="#merge-requirements" title="Permalink to this headline">¶</a></h2> 
          <ul class="simple"> 
           <li><p>Patches must <em>never</em> be pushed directly to <code class="docutils literal notranslate"><span class="pre">main</span></code>, all changes (even the most trivial typo fixes!) must be submitted as a pull request.</p></li> 
           <li><p>A patch that breaks tests, or introduces regressions by changing or removing existing tests should not be merged. Tests must always be passing on <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li> 
           <li><p>If somehow the tests get into a failing state on <code class="docutils literal notranslate"><span class="pre">main</span></code> (such as by a backwards incompatible release of a dependency) no pull requests may be merged until this is rectified.</p></li> 
           <li><p>All merged patches must have 100% test coverage.</p></li> 
           <li><p>All user facing strings must be marked for translation and the <code class="docutils literal notranslate"><span class="pre">.pot</span></code> and <code class="docutils literal notranslate"><span class="pre">.po</span></code> files must be updated.</p></li> 
          </ul> 
         </section> 
        </section> 
       </div> 
      </div> 
      <footer>
       <div class="rst-footer-buttons" role="navigation" aria-label="Footer"> <a href="submitting-patches.html" class="btn btn-neutral float-left" title="Submitting patches" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a> <a href="legacy-application-structure.html" class="btn btn-neutral float-right" title="Legacy Application URL Structure" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a> 
       </div> 
       <hr> 
       <div role="contentinfo"> 
        <p>© Copyright 2022. <span class="commit">Revision <code>140a2cc3</code>. </span></p> 
       </div> Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
      </footer> 
     </div> 
    </div> 
   </section> 
  </div> 
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions"> <span class="rst-current-version" data-toggle="rst-current-version"> <span class="fa fa-book"> Read the Docs</span> v: latest <span class="fa fa-caret-down"></span> </span> 
   <div class="rst-other-versions"> 
    <dl> 
     <dt>
      Versions
     </dt> 
     <dd>
      <a href="/en/latest/">latest</a>
     </dd> 
     <dd>
      <a href="/en/stable/">stable</a>
     </dd> 
    </dl> 
    <dl> 
     <dt>
      Downloads
     </dt> 
    </dl> 
    <dl> 
     <dt>
      On Read the Docs
     </dt> 
     <dd> <a href="//readthedocs.org/projects/warehouse/?fromdocs=warehouse">Project Home</a> 
     </dd> 
     <dd> <a href="//readthedocs.org/builds/warehouse/?fromdocs=warehouse">Builds</a> 
     </dd> 
    </dl> 
   </div> 
  </div> 
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
 </body>
</html>