<!doctype html>
<html class="writer-html5" lang="en"> 
 <head> 
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Submitting patches — Warehouse  documentation</title> 
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css"> 
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"> 
  <link rel="canonical" href="https://warehouse.pypa.io/development/submitting-patches.html"> <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]--> 
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script> 
  <script src="../_static/jquery.js"></script> 
  <script src="../_static/underscore.js"></script> 
  <script src="../_static/doctools.js"></script> 
  <script async src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script> 
  <script src="../_static/js/theme.js"></script> 
  <link rel="index" title="Index" href="../genindex.html"> 
  <link rel="search" title="Search" href="../search.html"> 
  <link rel="next" title="Reviewing and merging patches" href="reviewing-patches.html"> 
  <link rel="prev" title="Database migrations" href="database-migrations.html"> <!-- RTD Extra Head --> 
  <link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css"> 
  <script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2022-05-16T21:16:41Z", "builder": "sphinx", "canonical_url": null, "commit": "140a2cc3", "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "development/submitting-patches", "programming_language": "py", "project": "warehouse", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script> <!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
--> 
  <script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script> 
  <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async></script> <!-- end RTD <extrahead> --> 
 </head> 
 <body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav"> 
   <nav data-toggle="wy-nav-shift" class="wy-nav-side"> 
    <div class="wy-side-scroll"> 
     <div class="wy-side-nav-search"> <a href="../index.html" class="icon icon-home"> Warehouse </a> 
      <div class="version">
        latest 
      </div> 
      <div role="search"> 
       <form id="rtd-search-form" class="wy-form" action="../search.html" method="get"> 
        <input type="text" name="q" placeholder="Search docs"> 
        <input type="hidden" name="check_keywords" value="yes"> 
        <input type="hidden" name="area" value="default"> 
       </form> 
      </div> 
     </div>
     <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu"> 
      <ul class="current"> 
       <li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a>
        <ul class="current"> 
         <li class="toctree-l2"><a class="reference internal" href="getting-started.html">Getting started</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="frontend.html">Frontend</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="patterns.html">Patterns</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="database-migrations.html">Database migrations</a></li> 
         <li class="toctree-l2 current"><a class="current reference internal" href="#">Submitting patches</a>
          <ul> 
           <li class="toctree-l3"><a class="reference internal" href="#code">Code</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#tests">Tests</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#documentation">Documentation</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#translations">Translations</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#keeping-your-local-branch-updated">Keeping your local branch updated</a></li> 
          </ul> </li> 
         <li class="toctree-l2"><a class="reference internal" href="reviewing-patches.html">Reviewing and merging patches</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="legacy-application-structure.html">Legacy Application URL Structure</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="development-database.html">Updating Development Database</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="cloud.html">Developing in the cloud</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="email.html">Working with E-mails</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="malware-checks.html">Malware Checks</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="token-scanning.html">Token Scanning</a></li> 
        </ul> </li> 
       <li class="toctree-l1"><a class="reference internal" href="../application.html">Warehouse codebase</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../api-reference/index.html">API reference</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../ui-principles.html">UI principles</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../translations.html">Translations</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap and Sprints</a></li> 
      </ul> 
     </div> 
    </div> 
   </nav> 
   <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <nav class="wy-nav-top" aria-label="Mobile navigation menu"> <i data-toggle="wy-nav-top" class="fa fa-bars"></i> <a href="../index.html">Warehouse</a> 
    </nav> 
    <div class="wy-nav-content"> 
     <div class="rst-content"> 
      <div role="navigation" aria-label="Page navigation"> 
       <ul class="wy-breadcrumbs"> 
        <li><a href="../index.html" class="icon icon-home"></a> »</li> 
        <li><a href="index.html">Development</a> »</li> 
        <li>Submitting patches</li> 
        <li class="wy-breadcrumbs-aside"> <a href="https://github.com/pypa/warehouse/blob/main/docs/development/submitting-patches.rst" class="fa fa-github"> Edit on GitHub</a> </li> 
       </ul> 
       <hr> 
      </div> 
      <div role="main" class="document" itemscope itemtype="http://schema.org/Article"> 
       <div itemprop="articleBody"> 
        <section id="submitting-patches"> 
         <h1>Submitting patches<a class="headerlink" href="#submitting-patches" title="Permalink to this headline">¶</a></h1> 
         <p>Before you submit a patch, you may want to look at <a class="reference internal" href="../application.html"><span class="doc">our guide to the Warehouse codebase</span></a>.</p> 
         <p>As you work on your patch, keep this in mind:</p> 
         <ul class="simple"> 
          <li><p>Always make a new branch for your work.</p></li> 
          <li><p>Patches should be small to facilitate easier review. <a class="reference external" href="https://smartbear.com/smartbear/media/pdfs/wp-cc-11-best-practices-of-peer-code-review.pdf">Studies have shown</a> that review quality falls off as patch size grows. Sometimes this will result in many small PRs to land a single large feature.</p></li> 
          <li><p>You must have legal permission to distribute any code you contribute to Warehouse, and it must be available under the Apache Software License Version 2.0.</p></li> 
         </ul> 
         <p>If you believe you’ve identified a security issue in Warehouse, follow the directions on the <a class="reference internal" href="../security.html"><span class="doc">security page</span></a>.</p> 
         <section id="code"> 
          <h2>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h2> 
          <p>When in doubt, refer to <a class="reference external" href="https://github.com/ambv/black#the-black-code-style">the Black Code Style</a> for Python code formatting. You can reformat your code according to this code style by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">reformat</span></code> against it. You can check if your code meets all our automated requirements by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">lint</span></code> against it.</p> 
          <p><a class="reference external" href="http://nedbatchelder.com/blog/201401/comments_should_be_sentences.html">Write comments as complete sentences.</a></p> 
          <p>Class names which contains acronyms or initialisms should always be capitalized. A class should be named <code class="docutils literal notranslate"><span class="pre">HTTPClient</span></code>, not <code class="docutils literal notranslate"><span class="pre">HttpClient</span></code>.</p> 
          <p>Every code file must start with the boilerplate licensing notice:</p> 
          <div class="highlight-python notranslate">
           <div class="highlight">
            <pre><span></span><span class="c1"># Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
</pre>
           </div> 
          </div> 
          <p>You can view <a class="reference internal" href="patterns.html"><span class="doc">Patterns</span></a> to see more patterns that should be used within Warehouse.</p> 
         </section> 
         <section id="tests"> 
          <h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2> 
          <p>All code changes must be accompanied by unit tests with 100% code coverage (as measured by <a class="reference external" href="https://pypi.org/project/coverage">coverage.py</a>).</p> 
         </section> 
         <section id="documentation"> 
          <h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2> 
          <p>Important information should be documented with prose in the <code class="docutils literal notranslate"><span class="pre">docs</span></code> section. To ensure it builds and passes <a class="reference external" href="https://github.com/stackforge/doc8">doc8</a> style checks you can run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">docs</span></code> and <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">lint</span></code> respectively.</p> 
         </section> 
         <section id="translations"> 
          <h2>Translations<a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h2> 
          <p>When making changes to files with strings marked for translation, it’s necessary to update references to these files any time source strings are change, or the line numbers of the source strings in the source files. This can be done by running <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">translations</span></code>.</p> 
          <p>For instructions on how to mark strings and views for translation, see the <a class="reference external" href="https://warehouse.readthedocs.io/translations/">Translation Docs</a>.</p> 
         </section> 
         <section id="keeping-your-local-branch-updated"> 
          <h2>Keeping your local branch updated<a class="headerlink" href="#keeping-your-local-branch-updated" title="Permalink to this headline">¶</a></h2> 
          <p>As you work, you will need to keep your local <code class="docutils literal notranslate"><span class="pre">main</span></code> branch up-to-date with the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch in the main Warehouse repository, which moves forward as the maintainers merge pull requests. Most people working on the project use the following workflow.</p> 
          <p>This assumes that you have Git configured so that when you run the following command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git remote -v</span>
</pre>
           </div> 
          </div> 
          <p>Your output looks like this:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">origin  https://github.com/username/warehouse.git (fetch)</span>
<span class="go">origin  https://github.com/username/warehouse.git (push)</span>
<span class="go">upstream  https://github.com/pypa/warehouse.git (fetch)</span>
<span class="go">upstream  https://github.com/pypa/warehouse.git (push)</span>
</pre>
           </div> 
          </div> 
          <p>In the example above, <code class="docutils literal notranslate"><span class="pre">&lt;username&gt;</span></code> is your username on GitHub.</p> 
          <p>First, fetch the latest changes from the main Warehouse repository, <code class="docutils literal notranslate"><span class="pre">upstream</span></code>:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git fetch upstream</span>
</pre>
           </div> 
          </div> 
          <p>Then, check out your local <code class="docutils literal notranslate"><span class="pre">main</span></code> branch, and rebase the changes on top of it:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout main</span>
<span class="go">git rebase upstream/main</span>
</pre>
           </div> 
          </div> 
          <p>Next, push the updates you have just made to your local <code class="docutils literal notranslate"><span class="pre">main</span></code> branch to your <code class="docutils literal notranslate"><span class="pre">origin</span></code> repository on GitHub:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout main</span>
<span class="go">git push origin main</span>
</pre>
           </div> 
          </div> 
          <p>Now your local <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch in your <code class="docutils literal notranslate"><span class="pre">origin</span></code> repo have been updated with the most recent changes from the main Warehouse repository.</p> 
          <p>To keep your feature branches updated, the process is similar:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git checkout awesome-feature</span>
<span class="go">git fetch upstream</span>
<span class="go">git rebase upstream/main</span>
</pre>
           </div> 
          </div> 
          <p>Now your feature branch has been updated with the latest changes from the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch on the upstream Warehouse repository.</p> 
          <p>It’s good practice to back up your feature branches by pushing them to your <code class="docutils literal notranslate"><span class="pre">origin</span></code> on GitHub as you are working on them. To push a feature branch, run this command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git push origin awesome-feature</span>
</pre>
           </div> 
          </div> 
          <p>In this example, <code class="docutils literal notranslate"><span class="pre">&lt;awesome-feature&gt;</span></code> is the name of your feature branch. This will push the feature branch you are working on to GitHub, but will not create a PR.</p> 
          <p>Once you have pushed your feature branch to your <code class="docutils literal notranslate"><span class="pre">origin</span></code>, if you need to update it again, you will have to force push your changes by running the following command:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">git push -f origin awesome-feature</span>
</pre>
           </div> 
          </div> 
          <p>The <code class="docutils literal notranslate"><span class="pre">-f</span></code> (or <code class="docutils literal notranslate"><span class="pre">--force</span></code>) flag after <code class="docutils literal notranslate"><span class="pre">push</span></code> forces updates from your local branch to update your <code class="docutils literal notranslate"><span class="pre">origin</span></code> feature branch. If you have a PR open on your feature branch, force pushing will update your PR. (This is a useful command when someone requests changes on a PR.)</p> 
          <p>If you get an error message like this:</p> 
          <div class="highlight-console notranslate">
           <div class="highlight">
            <pre><span></span><span class="go">! [rejected]        awesome-feature -&gt; awesome-feature (non-fast-forward)</span>
<span class="go">error: failed to push some refs to 'https://github.com/USERNAME/warehouse.git'</span>
<span class="go">hint: Updates were rejected because the tip of your current branch is behind</span>
<span class="go">hint: its remote counterpart. Integrate the remote changes (e.g.</span>
<span class="go">hint: 'git pull ...') before pushing again.</span>
<span class="go">hint: See the 'Note about fast-forwards' in 'git push --help' for details.</span>
</pre>
           </div> 
          </div> 
          <p>Try force-pushing your feature branch with <code class="docutils literal notranslate"><span class="pre">push</span> <span class="pre">-f</span></code>.</p> 
          <p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> branch in the main Warehouse repository gets updated frequently as dependency upgrades are merged, so you will probably have to update your feature branch at least once while you are working on it.</p> 
         </section> 
        </section> 
       </div> 
      </div> 
      <footer>
       <div class="rst-footer-buttons" role="navigation" aria-label="Footer"> <a href="database-migrations.html" class="btn btn-neutral float-left" title="Database migrations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a> <a href="reviewing-patches.html" class="btn btn-neutral float-right" title="Reviewing and merging patches" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a> 
       </div> 
       <hr> 
       <div role="contentinfo"> 
        <p>© Copyright 2022. <span class="commit">Revision <code>140a2cc3</code>. </span></p> 
       </div> Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
      </footer> 
     </div> 
    </div> 
   </section> 
  </div> 
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions"> <span class="rst-current-version" data-toggle="rst-current-version"> <span class="fa fa-book"> Read the Docs</span> v: latest <span class="fa fa-caret-down"></span> </span> 
   <div class="rst-other-versions"> 
    <dl> 
     <dt>
      Versions
     </dt> 
     <dd>
      <a href="/en/latest/">latest</a>
     </dd> 
     <dd>
      <a href="/en/stable/">stable</a>
     </dd> 
    </dl> 
    <dl> 
     <dt>
      Downloads
     </dt> 
    </dl> 
    <dl> 
     <dt>
      On Read the Docs
     </dt> 
     <dd> <a href="//readthedocs.org/projects/warehouse/?fromdocs=warehouse">Project Home</a> 
     </dd> 
     <dd> <a href="//readthedocs.org/builds/warehouse/?fromdocs=warehouse">Builds</a> 
     </dd> 
    </dl> 
   </div> 
  </div> 
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
 </body>
</html>