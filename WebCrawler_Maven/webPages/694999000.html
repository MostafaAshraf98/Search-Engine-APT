<!doctype html>
<html class="writer-html5" lang="en"> 
 <head> 
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>Frontend — Warehouse  documentation</title> 
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css"> 
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css"> 
  <link rel="canonical" href="https://warehouse.pypa.io/development/frontend.html"> <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]--> 
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script> 
  <script src="../_static/jquery.js"></script> 
  <script src="../_static/underscore.js"></script> 
  <script src="../_static/doctools.js"></script> 
  <script async src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script> 
  <script src="../_static/js/theme.js"></script> 
  <link rel="index" title="Index" href="../genindex.html"> 
  <link rel="search" title="Search" href="../search.html"> 
  <link rel="next" title="Patterns" href="patterns.html"> 
  <link rel="prev" title="Getting started" href="getting-started.html"> <!-- RTD Extra Head --> 
  <link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css"> 
  <script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2022-05-16T21:16:41Z", "builder": "sphinx", "canonical_url": null, "commit": "140a2cc3", "docroot": "/docs/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "development/frontend", "programming_language": "py", "project": "warehouse", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "latest"}</script> <!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
--> 
  <script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script> 
  <script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async></script> <!-- end RTD <extrahead> --> 
 </head> 
 <body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav"> 
   <nav data-toggle="wy-nav-shift" class="wy-nav-side"> 
    <div class="wy-side-scroll"> 
     <div class="wy-side-nav-search"> <a href="../index.html" class="icon icon-home"> Warehouse </a> 
      <div class="version">
        latest 
      </div> 
      <div role="search"> 
       <form id="rtd-search-form" class="wy-form" action="../search.html" method="get"> 
        <input type="text" name="q" placeholder="Search docs"> 
        <input type="hidden" name="check_keywords" value="yes"> 
        <input type="hidden" name="area" value="default"> 
       </form> 
      </div> 
     </div>
     <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu"> 
      <ul class="current"> 
       <li class="toctree-l1 current"><a class="reference internal" href="index.html">Development</a>
        <ul class="current"> 
         <li class="toctree-l2"><a class="reference internal" href="getting-started.html">Getting started</a></li> 
         <li class="toctree-l2 current"><a class="current reference internal" href="#">Frontend</a>
          <ul> 
           <li class="toctree-l3"><a class="reference internal" href="#building">Building</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#tests">Tests</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#deploying">Deploying</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#browser-support">Browser Support</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#html-code-style">HTML Code Style</a></li> 
           <li class="toctree-l3"><a class="reference internal" href="#scss-style-and-structure">SCSS Style and Structure</a></li> 
          </ul> </li> 
         <li class="toctree-l2"><a class="reference internal" href="patterns.html">Patterns</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="database-migrations.html">Database migrations</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="submitting-patches.html">Submitting patches</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="reviewing-patches.html">Reviewing and merging patches</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="legacy-application-structure.html">Legacy Application URL Structure</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="development-database.html">Updating Development Database</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="cloud.html">Developing in the cloud</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="email.html">Working with E-mails</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="malware-checks.html">Malware Checks</a></li> 
         <li class="toctree-l2"><a class="reference internal" href="token-scanning.html">Token Scanning</a></li> 
        </ul> </li> 
       <li class="toctree-l1"><a class="reference internal" href="../application.html">Warehouse codebase</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../api-reference/index.html">API reference</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../ui-principles.html">UI principles</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../translations.html">Translations</a></li> 
       <li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap and Sprints</a></li> 
      </ul> 
     </div> 
    </div> 
   </nav> 
   <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
    <nav class="wy-nav-top" aria-label="Mobile navigation menu"> <i data-toggle="wy-nav-top" class="fa fa-bars"></i> <a href="../index.html">Warehouse</a> 
    </nav> 
    <div class="wy-nav-content"> 
     <div class="rst-content"> 
      <div role="navigation" aria-label="Page navigation"> 
       <ul class="wy-breadcrumbs"> 
        <li><a href="../index.html" class="icon icon-home"></a> »</li> 
        <li><a href="index.html">Development</a> »</li> 
        <li>Frontend</li> 
        <li class="wy-breadcrumbs-aside"> <a href="https://github.com/pypa/warehouse/blob/main/docs/development/frontend.rst" class="fa fa-github"> Edit on GitHub</a> </li> 
       </ul> 
       <hr> 
      </div> 
      <div role="main" class="document" itemscope itemtype="http://schema.org/Article"> 
       <div itemprop="articleBody"> 
        <section id="frontend"> 
         <h1>Frontend<a class="headerlink" href="#frontend" title="Permalink to this headline">¶</a></h1> 
         <p>The Warehouse frontend is (as you might suspect) written in JavaScript with the CSS handled by SCSS. It uses <code class="docutils literal notranslate"><span class="pre">gulp</span></code> to process these files and prepare them for serving.</p> 
         <p>All of the static files are located in <code class="docutils literal notranslate"><span class="pre">warehouse/static/</span></code> and external libraries are found in <code class="docutils literal notranslate"><span class="pre">package.json</span></code>.</p> 
         <section id="building"> 
          <h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2> 
          <p>Static files should be automatically built when <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">serve</span></code> is running; however, you can trigger a manual build of them by installing <a class="reference external" href="https://nodejs.org/en/download/releases/">NodeJS 14.x</a>, installing the dependencies using <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">install</span></code> and then running <code class="docutils literal notranslate"><span class="pre">gulp</span> <span class="pre">dist</span></code>.</p> 
          <p>If you’re in a POSIX environment you may find <a class="reference external" href="https://github.com/nvm-sh/nvm">NVM</a> useful to have multiple NodeJS versions installed in your system.</p> 
         </section> 
         <section id="tests"> 
          <h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2> 
          <p>The JavaScript codebase includes tests that can be ran via <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">static_tests</span></code>. This target will run the static tests in the Docker environment but they may also be ran locally using <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">run</span> <span class="pre">test</span></code> once NodeJS and the dependencies are installed as described above.</p> 
          <p>JavaScript tests use the <a class="reference external" href="https://jestjs.io/">Jest testing framework</a> along with <a class="reference external" href="https://github.com/testing-library/jest-dom">jest-dom</a> for assertion helpers. We can invoke Jest directly specify a particular test suite via <code class="docutils literal notranslate"><span class="pre">node_modules/.bin/jest</span> <span class="pre">tests/frontend/&lt;TEST_FILE&gt;.js</span></code> or add any of the <a class="reference external" href="https://jestjs.io/docs/en/cli">Jest CLI options</a> . All tests are located in the <code class="docutils literal notranslate"><span class="pre">tests/frontend</span></code>.</p> 
          <p><a class="reference external" href="https://stimulusjs.org/">Stimulus</a> controller tests leverage on Jest including <a class="reference external" href="https://github.com/jsdom/jsdom/">JSDOM</a> allowing us to inject the required HTML markup for Stimulus in a setup phase. After the setup we must manually instantiate and start a Stimulus application and then test the funcionality by triggering events in DOM elements and asserting on the effects. See existing tests the details on how to accomplish this.</p> 
          <div class="admonition note"> 
           <p class="admonition-title">Note</p> 
           <p>This workflow may cause race conditions, in particular when testing code in the early lifecycle events of the controllers. The application or controller may not be ready by the time we reach the assertions causing false negatives on the tests. In these cases it’s best to keep the HTML setup in a <code class="docutils literal notranslate"><span class="pre">beforeEach</span></code> block, even if it means repeating the setup on different <code class="docutils literal notranslate"><span class="pre">describe</span></code> scenarios. This will ensure the application and controllers are ready before the actual test is ran.</p> 
          </div> 
         </section> 
         <section id="deploying"> 
          <h2>Deploying<a class="headerlink" href="#deploying" title="Permalink to this headline">¶</a></h2> 
          <p>When deploying changes to the frontend, to see the changes immediately it is necessary to purge the cache.</p> 
          <p>Individual pages can be purged from the command line by issuing a <code class="docutils literal notranslate"><span class="pre">XPURGE</span></code> request, e.g.:</p> 
          <div class="highlight-default notranslate">
           <div class="highlight">
            <pre><span></span><span class="n">curl</span> <span class="o">-</span><span class="n">XPURGE</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">the</span><span class="o">/</span><span class="n">page</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">purge</span>
</pre>
           </div> 
          </div> 
          <p>All HTML pages can be dropped from the cache by purging the <code class="docutils literal notranslate"><span class="pre">all-html</span></code> surrogate key via our CDN provider.</p> 
          <p>The entire cache can be purged by issuing a “Purge All” via our CDN provider.</p> 
          <p>Purging the cache is not usually necessary when making frontend changes, unless it would be unacceptable for the site to simultaneously have an “old” version of some pages, but the “new” version of others.</p> 
         </section> 
         <section id="browser-support"> 
          <h2>Browser Support<a class="headerlink" href="#browser-support" title="Permalink to this headline">¶</a></h2> 
          <p>We aim to support all major browsers, including IE11. We also support one-back, and follow the <code class="docutils literal notranslate"><span class="pre">defaults</span></code> recommendation from <code class="docutils literal notranslate"><span class="pre">browserslist</span></code>.</p> 
          <p>You can see the full list of supported browsers by running <code class="docutils literal notranslate"><span class="pre">npx</span> <span class="pre">browserslist</span></code> in the root of the project.</p> 
         </section> 
         <section id="html-code-style"> 
          <h2>HTML Code Style<a class="headerlink" href="#html-code-style" title="Permalink to this headline">¶</a></h2> 
          <p>Warehouse follows the <a class="reference external" href="https://google.github.io/styleguide/htmlcssguide.html">Google HTML style guide</a>, which is enforced via linting with <a class="reference external" href="https://github.com/deezer/html-linter">HTML Linter</a>.</p> 
          <p>Exceptions to these rules include:</p> 
          <ul class="simple"> 
           <li><p>Protocols can be included in links - we prefer to include <code class="docutils literal notranslate"><span class="pre">https</span></code> protocols</p></li> 
           <li><p>All HTML tags should be closed</p></li> 
          </ul> 
          <p>We also allow both dashes and underscores in our class names, as we follow the <a class="reference external" href="http://nicolasgallagher.com/about-html-semantics-front-end-architecture/">Nicholas Gallagher variation</a> of the <a class="reference external" href="https://en.bem.info/">BEM naming methodology</a>.</p> 
          <p>More information on how BEM works can be found in <a class="reference external" href="https://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/">this article from CSS Wizardry</a>.</p> 
          <p>When using <code class="docutils literal notranslate"><span class="pre">target="_blank_"</span></code> for a hyperlink (usually to an external site), we should always set <code class="docutils literal notranslate"><span class="pre">rel="noopener"</span></code>.</p> 
         </section> 
         <section id="scss-style-and-structure"> 
          <h2>SCSS Style and Structure<a class="headerlink" href="#scss-style-and-structure" title="Permalink to this headline">¶</a></h2> 
          <p>Warehouse follows the <a class="reference external" href="https://github.com/airbnb/css">Airbnb CSS/Sass style guide</a>, with the exception that JS hooks should be prefixed with <code class="docutils literal notranslate"><span class="pre">-js</span></code> rather than <code class="docutils literal notranslate"><span class="pre">js</span></code>.</p> 
          <p>Our SCSS codebase is structured according to the <a class="reference external" href="https://www.creativebloq.com/web-design/manage-large-scale-web-projects-new-css-architecture-itcss-41514731">ITCSS system</a>. The principle of this system is to break SCSS code into layers and import them into a main stylesheet in an order moving from generic to specific. This tightly controls the cascade of styles.</p> 
          <p>The majority of the SCSS styles are found within the ‘blocks’ layer, with each BEM block in its own file. All blocks are documented at the top of the file to provide guidelines for use and modification.</p> 
          <p>One of these blocks provides code syntax highlighting, which can be tested with reference project provided at <a class="reference external" href="http://localhost/project/pypi-code-highlighting-demo/">http://localhost/project/pypi-code-highlighting-demo/</a> when using development database. Source reStructuredText file is available <a class="reference external" href="https://github.com/evemorgen/pypi-code-highlighting-demo">here</a>.</p> 
         </section> 
        </section> 
       </div> 
      </div> 
      <footer>
       <div class="rst-footer-buttons" role="navigation" aria-label="Footer"> <a href="getting-started.html" class="btn btn-neutral float-left" title="Getting started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a> <a href="patterns.html" class="btn btn-neutral float-right" title="Patterns" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a> 
       </div> 
       <hr> 
       <div role="contentinfo"> 
        <p>© Copyright 2022. <span class="commit">Revision <code>140a2cc3</code>. </span></p> 
       </div> Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
      </footer> 
     </div> 
    </div> 
   </section> 
  </div> 
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions"> <span class="rst-current-version" data-toggle="rst-current-version"> <span class="fa fa-book"> Read the Docs</span> v: latest <span class="fa fa-caret-down"></span> </span> 
   <div class="rst-other-versions"> 
    <dl> 
     <dt>
      Versions
     </dt> 
     <dd>
      <a href="/en/latest/">latest</a>
     </dd> 
     <dd>
      <a href="/en/stable/">stable</a>
     </dd> 
    </dl> 
    <dl> 
     <dt>
      Downloads
     </dt> 
    </dl> 
    <dl> 
     <dt>
      On Read the Docs
     </dt> 
     <dd> <a href="//readthedocs.org/projects/warehouse/?fromdocs=warehouse">Project Home</a> 
     </dd> 
     <dd> <a href="//readthedocs.org/builds/warehouse/?fromdocs=warehouse">Builds</a> 
     </dd> 
    </dl> 
   </div> 
  </div> 
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  
 </body>
</html>