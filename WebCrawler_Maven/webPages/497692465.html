<!doctype html>
<html lang="en"> 
 <head> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <title>PyPI deployment - Travis CI</title> 
  <link rel="stylesheet" href="/assets/stylesheets/main.css"> 
  <link rel="alternate" type="application/rss+xml" title="Travis CI Build Environment Updates" href="https://docs.travis-ci.com/feed.build-env-updates.xml"> 
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script> 
  <script src="/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script> 
  <script src="/assets/javascripts/prism.js" type="text/javascript" charset="utf-8" defer></script> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:site" content="@travisci"> 
  <meta name="twitter:creator" content="@travisci"> 
  <meta property="og:title" content="Travis CI Documentation"> 
  <meta property="og:type" content="website"> 
  <meta property="og:url" content="/user/deployment/pypi/"> 
  <meta property="og:description" content="PyPI deployment"> 
  <meta property="og:image" content="/images/TravisCI-Full-Color.png" }}> 
  <meta property="og:image:type" content="image/png"> 
  <meta property="og:image:width" content="642"> 
  <meta property="og:image:height" content="201"> 
  <meta property="og:image:alt" content="Travis CI logo"> 
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24868285-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script> 
 </head> 
 <body> 
  <div class="wrapper"> 
   <header class="top"> 
    <div class="row topbar"> 
     <h1 id="logo" class="logo"> <a href="https://travis-ci.com/" title="Travis CI">Travis</a> </h1> 
     <nav> 
      <ul id="navigation" class="navigation"> 
       <li><a href="https://blog.travis-ci.com">Blog</a></li> 
       <li><a href="/">Docs</a></li> 
       <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li> 
      </ul> 
     </nav> 
    </div> 
   </header> 
   <div id="content" class="row"> 
    <div id="sidebar" class="sidebar"> 
     <div> <!-- <h2>Search</h2> --> 
      <div class="searchbox"> 
       <form> 
        <input type="text" id="st-search-input" class="searchbox-input" placeholder="Search the docs"> 
       </form> 
       <script type="text/javascript">
      var Swiftype = window.Swiftype || {};
        (function() {
          Swiftype.key = 'tXvDDzd4fNTBnLvxfEyx';

          Swiftype.searchSearchFields = {
            "page": ["title, body, tags"]
          };
          Swiftype.autocompleteSearchFields = {
            "page": ["title, body, tags"]
          };
          /** DO NOT EDIT BELOW THIS LINE **/
          var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
          script.src = "//swiftype.com/embed.js";
          var entry = document.getElementsByTagName('script')[0];
          document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
        }());
      </script> 
      </div> 
     </div> 
     <section class="sidebar-navigation"> 
      <nav> 
       <h3>Getting Started</h3> 
       <ul> 
        <li><a href="/user/for-beginners/">Core Concepts for Beginners</a></li> 
        <li><a href="/user/tutorial/">Travis CI Tutorial</a></li> 
        <li><a href="/user/customizing-the-build/">Customizing the Build</a></li> 
        <li><a href="/user/speeding-up-the-build/">Speeding up the Build</a></li> 
        <li><a href="/user/docker/">Using Docker in your Build</a></li> 
        <li><a href="/user/gui-and-headless-browsers/">Headless Testing with Browsers</a></li> 
        <li><a href="/user/pull-requests/">Building Pull Requests</a></li> 
        <li><a href="/user/cron-jobs/">Cron Jobs</a></li> 
        <li><a href="/user/common-build-problems/">Common Build Problems</a></li> 
        <li><a href="https://github.com/travis-ci/travis#readme">Command Line Client</a></li> 
        <li><a href="/user/build-config-imports/">Build Config Imports</a></li> 
        <li><a href="/user/build-config-validation/">Build Config Validation</a></li> 
       </ul> 
       <h3>Jobs, Builds, Matrices and Stages</h3> 
       <ul> 
        <li><a href="/user/job-lifecycle/">Job Lifecycle</a></li> 
        <li><a href="/user/build-matrix/">Build Matrix</a></li> 
        <li><a href="/user/build-stages/">Build Stages</a></li> 
        <li><a href="/user/conditional-builds-stages-jobs/">Conditional Builds, Stages, and Jobs</a></li> 
       </ul> 
       <h3>Installing Dependencies</h3> 
       <ul> 
        <li><a href="/user/installing-dependencies/">Installing Dependencies</a></li> 
        <li><a href="/user/private-dependencies/">Private Dependencies GitHub</a></li> 
        <li><a href="/user/private-dependencies-bb/">Private Dependencies Bitbucket</a></li> 
        <li><a href="/user/database-setup/">Setting up Services and Databases</a></li> 
        <li><a href="/user/caching/">Caching Dependencies</a></li> 
        <li><a href="/user/ssh-known-hosts/">Adding to SSH Known Hosts</a></li> 
       </ul> 
       <h3>Programming Languages</h3> 
       <ul> 
        <li><a href="/user/languages/android/">Android</a></li> 
        <li><a href="/user/languages/c/">C</a></li> 
        <li><a href="/user/languages/csharp/">C#</a></li> 
        <li><a href="/user/languages/cpp/">C++</a></li> 
        <li><a href="/user/languages/clojure/">Clojure</a></li> 
        <li><a href="/user/languages/crystal/">Crystal</a></li> 
        <li><a href="/user/languages/d/">D</a></li> 
        <li><a href="/user/languages/dart/">Dart</a></li> 
        <li><a href="/user/languages/elixir/">Elixir</a></li> 
        <li><a href="/user/languages/elm/">Elm</a></li> 
        <li><a href="/user/languages/erlang/">Erlang</a></li> 
        <li><a href="/user/languages/csharp/">F#</a></li> 
        <li><a href="/user/languages/minimal-and-generic/">Generic</a></li> 
        <li><a href="/user/languages/go/">Go</a></li> 
        <li><a href="/user/languages/groovy/">Groovy</a></li> 
        <li><a href="/user/languages/haskell/">Haskell</a></li> 
        <li><a href="/user/languages/haxe/">Haxe</a></li> 
        <li><a href="/user/languages/java/">Java</a></li> 
        <li><a href="/user/languages/javascript-with-nodejs/">JavaScript <small>(with Node.js)</small></a></li> 
        <li><a href="/user/languages/julia/">Julia</a></li> 
        <li><a href="/user/languages/matlab/">MATLAB</a></li> 
        <li><a href="/user/languages/minimal-and-generic/">Minimal</a></li> 
        <li><a href="/user/languages/nix/">Nix</a></li> 
        <li><a href="/user/languages/objective-c/">Objective-C</a></li> 
        <li><a href="/user/languages/perl/">Perl</a></li> 
        <li><a href="/user/languages/perl6/">Perl6</a></li> 
        <li><a href="/user/languages/php/">PHP</a></li> 
        <li><a href="/user/languages/python/">Python</a></li> 
        <li><a href="/user/languages/r/">R</a></li> 
        <li><a href="/user/languages/ruby/">Ruby</a></li> 
        <li><a href="/user/languages/rust/">Rust</a></li> 
        <li><a href="/user/languages/scala/">Scala</a></li> 
        <li><a href="/user/languages/smalltalk/">Smalltalk</a></li> 
        <li><a href="/user/languages/objective-c/">Swift</a></li> 
        <li><a href="/user/languages/csharp/">Visual Basic</a></li> 
        <li><a href="/user/languages/community-supported-languages/">Adding a language</a></li> 
       </ul> 
       <h3>Deployments and Uploads</h3> 
       <ul> 
        <li class="is-overview"><a href="/user/deployment/">Overview</a></li> 
        <li><a href="/user/deployment/anynines/">anynines</a></li> 
        <li><a href="/user/deployment/atlas/">Atlas</a></li> 
        <li><a href="/user/deployment/codedeploy/">AWS CodeDeploy</a></li> 
        <li><a href="/user/deployment/elasticbeanstalk/">AWS Elastic Beanstalk</a></li> 
        <li><a href="/user/deployment/lambda/">AWS Lambda</a></li> 
        <li><a href="/user/deployment/opsworks/">AWS OpsWorks</a></li> 
        <li><a href="/user/deployment/s3/">AWS S3</a></li> 
        <li><a href="/user/deployment/azure-web-apps/">Azure Web Apps</a></li> 
        <li><a href="/user/deployment/bintray/">bintray</a></li> 
        <li><a href="/user/deployment/bitballoon/">BitBalloon</a></li> 
        <li><a href="/user/deployment/bluemixcloudfoundry/">Bluemix CloudFoundry</a></li> 
        <li><a href="/user/deployment/boxfuse/">Boxfuse</a></li> 
        <li><a href="/user/deployment/catalyze/">Catalyze</a></li> 
        <li><a href="/user/deployment/chefsupermarket/">Chef Supermarket</a></li> 
        <li><a href="/user/deployment/cloud66/">Cloud 66</a></li> 
        <li><a href="/user/deployment/cloudfoundry/">CloudFoundry</a></li> 
        <li><a href="/user/deployment/cargo/">Cargo</a></li> 
        <li><a href="/user/deployment/engineyard/">Engine Yard</a></li> 
        <li><a href="/user/deployment/pages/">GitHub Pages</a></li> 
        <li><a href="/user/deployment/releases/">GitHub Releases</a></li> 
        <li><a href="/user/deployment/google-app-engine/">Google App Engine</a></li> 
        <li><a href="/user/deployment/gcs/">Google Cloud Storage</a></li> 
        <li><a href="/user/deployment/firebase/">Google Firebase</a></li> 
        <li><a href="/user/deployment/hackage/">Hackage</a></li> 
        <li><a href="/user/deployment/hephy/">Hephy</a></li> 
        <li><a href="/user/deployment/heroku/">Heroku</a></li> 
        <li><a href="/user/deployment/launchpad/">Launchpad</a></li> 
        <li><a href="/user/deployment/npm/">npm</a></li> 
        <li><a href="/user/deployment/openshift/">OpenShift</a></li> 
        <li><a href="/user/deployment/packagecloud/">packagecloud.io</a></li> 
        <li><a href="/user/deployment/puppetforge/">Puppet Forge</a></li> 
        <li><a href="/user/deployment/pypi/">PyPI</a></li> 
        <li><a href="/user/deployment/cloudfiles/">Rackspace Cloud Files</a></li> 
        <li><a href="/user/deployment/rubygems/">RubyGems</a></li> 
        <li><a href="/user/deployment/scalingo/">Scalingo</a></li> 
        <li><a href="/user/deployment/script/">Script</a></li> 
        <li><a href="/user/deployment/snaps/">Snap Store</a></li> 
        <li><a href="/user/deployment/surge/">Surge.sh</a></li> 
        <li><a href="/user/deployment/testfairy/">TestFairy</a></li> 
        <li><a href="/user/deployment/transifex/">Transifex</a></li> 
        <li><a href="/user/uploading-artifacts/">Uploading Build Artifacts</a></li> 
       </ul> 
       <h3>CI Environment Reference</h3> 
       <ul> 
        <li class="is-overview"><a href="/user/reference/overview/">Overview</a></li> 
        <li><a href="/user/reference/linux/">Ubuntu Linux CI Environment References</a></li> 
        <li><a href="/user/reference/osx/">macOS CI Environment Reference</a></li> 
        <li><a href="/user/reference/windows/">Windows CI Environment Reference</a></li> 
        <li><a href="/user/reference/freebsd/">FreeBSD CI Environment Reference</a></li> 
        <li><a href="/user/multi-os/">Building on Multiple Operating Systems</a></li> 
        <li><a href="/user/multi-cpu-architectures/">Building on Multiple CPU Architectures</a></li> 
        <li><a href="/user/environment-variables/">Environment Variables</a></li> 
        <li><a href="/user/build-environment-updates/">Build Environment Updates</a></li> 
        <li><a href="/user/ip-addresses/">Build Machines IP Addresses</a></li> 
       </ul> 
       <h3>Encrypting Files and Data</h3> 
       <ul> 
        <li><a href="/user/encryption-keys/">Encrypting Sensitive Data</a></li> 
        <li><a href="/user/encrypting-files/">Encrypting Files</a></li> 
        <li><a href="/user/github-oauth-scopes/">GitHub Permissions used by Travis CI</a></li> 
        <li><a href="/user/bb-oauth-scopes/">Bitbucket Permissions used by Travis CI</a></li> 
        <li><a href="/user/assembla-oauth-scopes/">Assembla Permissions used by Travis CI</a></li> 
        <li><a href="/user/gl-oauth-scopes/">GitLab Permissions used by Travis CI</a></li> 
        <li><a href="/user/best-practices-security/">Best Practices in Securing Your Data</a></li> 
       </ul> 
       <h3>Integrations and Notifications</h3> 
       <ul> 
        <li><a href="/user/notifications/">Configuring Notifications</a></li> 
        <li><a href="/user/status-images/">Showing Build Status Images</a></li> 
        <li><a href="/user/code-climate/">Code Climate</a></li> 
        <li><a href="/user/deepsource/">DeepSource</a></li> 
        <li><a href="/user/coveralls/">Coveralls</a></li> 
        <li><a href="/user/coverity-scan/">Coverity Scan</a></li> 
        <li><a href="/user/browserstack/">BrowserStack</a></li> 
        <li><a href="/user/sauce-connect/">Sauce Labs</a></li> 
        <li><a href="/user/sonarcloud/">SonarCloud</a></li> 
        <li><a href="/user/sourceclear/">SourceClear</a></li> 
        <li><a href="/user/build-feeds/">Atom Feeds</a></li> 
        <li><a href="/user/cc-menu/">CCMenu / CCTray Feeds</a></li> 
        <li><a href="/user/integration/platformio/">Embedded Builds with PlatformIO</a></li> 
        <li><a href="/user/apps/">3rd Party Apps, Clients and Tools</a></li> 
       </ul> 
       <h3>Developer Program</h3> 
       <ul> 
        <li class="is-overview"><a href="/user/developer/">Overview</a></li> 
        <li><a href="https://developer.travis-ci.com/">API V3</a></li> 
        <li><a href="/user/triggering-builds/">Triggering Builds with API V3</a></li> 
        <li><a href="https://github.com/travis-ci/travis#ruby-library">The Ruby Library</a></li> 
       </ul> 
       <h3>Hosted Billing</h3> 
       <ul> 
        <li class="is-overview"><a href="/user/billing-overview/">Overview</a></li> 
        <li><a href="/user/billing-autorefill/">Auto-refill</a></li> 
        <li><a href="/user/billing-faq/">FAQ</a></li> 
       </ul> 
       <h3>Travis CI Enterprise</h3> 
       <ul> 
        <li><a href="/user/enterprise/">Enterprise Docs</a></li> 
       </ul> 
      </nav> 
     </section> 
     <section class="sidebar-notice"> 
      <p>This documentation site is open source. The <a href="https://github.com/travis-ci/docs-travis-ci-com">README in our Git repository</a> explains how to contribute.</p> 
     </section> 
    </div><!-- /#sidebar --> 
    <main id="main" class="main" data-swiftype-index="true"> 
     <aside class="improve-page" data-swiftype-index="false">
      <a href="https://github.com/travis-ci/docs-travis-ci-com/edit/master/user/deployment/pypi.md" target="_blank" title="Edit this page on GitHub" class="button-pen" data-proofer-ignore>Improve this page on GitHub</a>
     </aside> 
     <h1 class="title">PyPI deployment</h1> 
     <blockquote> 
      <p> This page documents deployments using dpl v1 which currently is the default version. The next major version dpl v2 will be released soon, and we recommend starting to use it. Please see <a href="https://blog.travis-ci.com/2019-08-27-deployment-tooling-dpl-v2-preview-release">our blog post</a> for details. <a href="/user/deployment-v2">dpl v2 documentation can be found here</a>. </p> 
     </blockquote> 
     <div id="toc" class="toc"> 
      <ul class="list-language"> 
       <li><a href="#deploying-tags">Deploying tags</a></li> 
       <li><a href="#deploying-specific-branches">Deploying specific branches</a></li> 
       <li><a href="#releasing-to-a-self-hosted-pypi">Releasing to a self hosted PyPI</a></li> 
       <li><a href="#uploading-different-distributions">Uploading different distributions</a></li> 
       <li><a href="#upload-artifacts-only-once">Upload artifacts only once</a></li> 
       <li><a href="#releasing-build-artifacts">Releasing build artifacts</a></li> 
       <li><a href="#conditional-releases">Conditional releases</a></li> 
       <li><a href="#running-commands-before-and-after-release">Running commands before and after release</a></li> 
      </ul> 
     </div> 
     <p>Travis CI can automatically release your Python package to <a href="https://pypi.python.org/">PyPI</a> after a successful build.</p> 
     <p>For a minimal configuration, generate <a href="https://pypi.org/help/#apitoken">PyPI API token</a> and add the following to your <code class="highlighter-rouge">.travis.yml</code>:</p> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">__token__"</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Your</span><span class="nv"> </span><span class="s">PyPI</span><span class="nv"> </span><span class="s">API</span><span class="nv"> </span><span class="s">token,</span><span class="nv"> </span><span class="s">including</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">pypi-</span><span class="nv"> </span><span class="s">prefix"</span>
</code></pre>
      </div>
     </div> 
     <p>However, this would expose your PyPI API token to the world. We recommend you <a href="/user/encryption-keys/">encrypt</a> your password and add it to your .travis.yml by running:</p> 
     <div class="language-bash highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>travis encrypt your-api-token <span class="nt">--add</span> deploy.password
</code></pre>
      </div>
     </div> 
     <p>If you are using travis-ci.com and not travis-ci.org, you need to add the <code class="highlighter-rouge">--com</code> argument to switch the Travis API endpoint:</p> 
     <div class="language-bash highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>travis encrypt your-api-token <span class="nt">--add</span> deploy.password <span class="nt">--com</span>
</code></pre>
      </div>
     </div> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s2">"</span><span class="s">__token__"</span>
  <span class="na">password</span><span class="pi">:</span>
    <span class="na">secure</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Your</span><span class="nv"> </span><span class="s">encrypted</span><span class="nv"> </span><span class="s">token"</span>
</code></pre>
      </div>
     </div> 
     <p>It is also possible, but not recommended, to use PyPI user and password, instead of token.</p> 
     <blockquote> 
      <p>Note that if your PyPI password contains <a href="/user/encryption-keys#note-on-escaping-certain-symbols">special characters</a> you need to escape them before encrypting your password. Some people have <a href="https://github.com/travis-ci/dpl/issues/377">reported difficulties</a> connecting to PyPI with passwords containing anything except alphanumeric characters.</p> 
     </blockquote> 
     <h2 id="deploying-tags">Deploying tags <a href="#deploying-tags" class="toc-anchor">#</a></h2> 
     <p>Most likely, you would only want to deploy to PyPI when a new version of your package is cut. To do this, you can tell Travis CI to only deploy on tagged commits, like so:</p> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">tags</span><span class="pi">:</span> <span class="no">true</span>
</code></pre>
      </div>
     </div> 
     <p>If you tag a commit locally, remember to run <code class="highlighter-rouge">git push --tags</code> to ensure that your tags are uploaded to GitHub.</p> 
     <h2 id="deploying-specific-branches">Deploying specific branches <a href="#deploying-specific-branches" class="toc-anchor">#</a></h2> 
     <p>You can explicitly specify the branch to release from with the <strong>on</strong> option:</p> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">branch</span><span class="pi">:</span> <span class="s">production</span>
</code></pre>
      </div>
     </div> 
     <p>Alternatively, you can also configure Travis CI to release from all branches:</p> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">all_branches</span><span class="pi">:</span> <span class="no">true</span>
</code></pre>
      </div>
     </div> 
     <p>By default, Travis CI will only release from the <strong>master</strong> branch.</p> 
     <p>Builds triggered from Pull Requests will never trigger a release.</p> 
     <h2 id="releasing-to-a-self-hosted-pypi">Releasing to a self hosted PyPI <a href="#releasing-to-a-self-hosted-pypi" class="toc-anchor">#</a></h2> 
     <p>To release to a different PyPI index:</p> 
     <div data-file=".travis.yml" class="language-yaml highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code><span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pypi</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s">...</span>
  <span class="na">server</span><span class="pi">:</span> <span class="s">https://mypackageindex.com/index</span>
</code></pre>
      </div>
     </div> 
     <h2 id="uploading-different-distributions">Uploading different distributions <a href="#uploading-different-distributions" class="toc-anchor">#</a></h2> 
     <p>By default, only a source distribution (ësdistí) will be uploaded to PyPI. If you would like to upload different distributions, specify them using the <code class="highlighter-rouge">distributions</code> option, like this:</p> 
     <div class="highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>deploy:
  provider: pypi
  username: ...
  password: ...
  distributions: "sdist bdist_wheel" # Your distributions here
</code></pre>
      </div>
     </div> 
     <p>If you specify <code class="highlighter-rouge">bdist_wheel</code> in the distributions, the <code class="highlighter-rouge">wheel</code> package will automatically be installed.</p> 
     <h2 id="upload-artifacts-only-once">Upload artifacts only once <a href="#upload-artifacts-only-once" class="toc-anchor">#</a></h2> 
     <p>By default, Travis CI runs the deploy stage for each <code class="highlighter-rouge">python</code> and <code class="highlighter-rouge">environment</code> that you specify. Many of these will generate competing build artifacts that will fail to upload to pypi with a message something like this:</p> 
     <div class="highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>HTTPError: 400 Client Error: File already exists. See https://pypi.org/help/#file-name-reuse for url: https://upload.pypi.org/legacy/
</code></pre>
      </div>
     </div> 
     <p>To avoid this, use the <code class="highlighter-rouge">skip_existing</code> flag:</p> 
     <div class="highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>deploy:
  provider: pypi
  username: ...
  password: ...
  skip_existing: true
</code></pre>
      </div>
     </div> 
     <h2 id="releasing-build-artifacts">Releasing build artifacts <a href="#releasing-build-artifacts" class="toc-anchor">#</a></h2> 
     <p>After your tests ran and before the release, Travis CI will clean up any additional files and changes you made.</p> 
     <p>Maybe that is not what you want, as you might generate some artifacts that are supposed to be released, too. There is now an option to skip the clean up:</p> 
     <div class="highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>deploy:
  provider: pypi
  username: ...
  password: ...
  skip_cleanup: true
</code></pre>
      </div>
     </div> 
     <h2 id="conditional-releases">Conditional releases <a href="#conditional-releases" class="toc-anchor">#</a></h2> 
     <p>You can deploy only when certain conditions are met. See <a href="/user/deployment#conditional-releases-with-on">Conditional Releases with <code class="highlighter-rouge">on:</code></a>.</p> 
     <h2 id="running-commands-before-and-after-release">Running commands before and after release <a href="#running-commands-before-and-after-release" class="toc-anchor">#</a></h2> 
     <p>Sometimes you want to run commands before or after releasing a package. You can use the <code class="highlighter-rouge">before_deploy</code> and <code class="highlighter-rouge">after_deploy</code> stages for this. These will only be triggered if Travis CI is actually pushing a release.</p> 
     <div class="highlighter-rouge">
      <div class="highlight">
       <pre class="highlight"><code>before_deploy: "echo 'ready?'"
deploy:
  ..
after_deploy:
  - ./after_deploy_1.sh
  - ./after_deploy_2.sh
</code></pre>
      </div>
     </div> 
    </main> 
   </div><!-- /#content --> 
   <footer class="footer"> 
    <div class="layout-inner"> 
     <div class="footer-elem"> 
      <svg width="142px" height="45.381px" viewbox="0 0 142 45.381" enable-background="new 0 0 142 45.381" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> 
       <title>Travis CI Mascot</title> <image xlink:href="https://styleguide.travis-ci.com/images/logos/travis-footer-logo-new.svg" x="0" y="0" width="142px" height="45.381px" /> 
      </svg> 
     </div> 
     <div class="footer-elem"></div> 
     <div class="footer-elem"> 
      <h3 class="footer-title">©Travis CI, GmbH</h3> 
      <address>Rigaer Straﬂe 8<br>10247 Berlin, Germany</address> 
      <ul> 
       <li><a href="https://travisci.workable.com/" title="Jobs at Travis CI">Work with Travis CI</a></li> 
      </ul> 
     </div> 
     <div class="footer-elem"> 
      <h3 class="footer-title">Help</h3> 
      <ul> 
       <li><a href="https://docs.travis-ci.com" title="Travis CI Docs">Documentation</a></li> 
       <li><a href="https://changelog.travis-ci.com/">Changelog</a></li> 
       <li><a href="https://blog.travis-ci.com/" title="Travis CI Blog">Blog</a></li> 
       <li><a href="mailto:support@travis-ci.com" title="Email Travis CI support">Email</a></li> 
       <li><a href="https://twitter.com/travisci" title="Travis CI on Twitter">Twitter</a></li> 
      </ul> 
     </div> 
     <div class="footer-elem"> 
      <h3 class="footer-title">Company</h3> 
      <ul> 
       <li><a href="/imprint.html" title="Imprint">Imprint</a></li> 
       <li><a href="https://ideracorp.com/legal/TravisCI">Legal</a></li> 
      </ul> 
     </div> 
     <div class="footer-elem"> 
      <h3 class="footer-title">Travis CI Status</h3> 
      <ul> 
       <li>
        <div class="status-circle none">
         Status:
        </div> <a href="http://www.traviscistatus.com/">Travis CI Status</a> </li> 
      </ul> 
     </div> 
    </div> 
   </footer> 
   <script>
 fetch('https://pnpcptp8xh9k.statuspage.io/api/v2/status.json').then(function(response) {
   return response.json();
 }).then(function(data) {
   if (data.status && data.status.indicator) {
     document.querySelector('.status-circle').classList.add(data.status.indicator);
   }
 });
</script> 
  </div><!-- /.wrapper -->  
 </body>
</html>